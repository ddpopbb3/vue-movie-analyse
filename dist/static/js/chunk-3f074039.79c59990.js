(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f074039"],{1:function(t,e){},2:function(t,e){},3:function(t,e){},a28e:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("upload-excel-component",{attrs:{"on-success":t.handleSuccess,"before-upload":t.beforeUpload}})],1)},s=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-button",{attrs:{type:"primary"},on:{click:t.showChart}},[t._v("显示图表")]),t._v(" "),a("el-row",{staticStyle:{background:"#fff",padding:"16px 16px 0","margin-bottom":"32px"}},[a("div",{style:{height:t.height,width:t.width},attrs:{id:"contrastchart"}})]),t._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{xs:24,sm:24,lg:8}},[a("div",{staticClass:"chart-wrapper"},[a("div",{style:{height:t.height,width:"550px"},attrs:{id:"manchart"}})])]),t._v(" "),a("el-col",{attrs:{xs:24,sm:24,lg:8}},[a("div",{staticClass:"chart-wrapper"},[a("div",{style:{height:t.height,width:"550px"},attrs:{id:"womanchart"}})])])],1)],1)},i=[],o=(a("7f7f"),a("1146")),l=a.n(o),c=a("bc3a"),h=a.n(c),u=a("313e"),d=a.n(u),p={props:{beforeUpload:Function,onSuccess:Function,width:{type:String,default:"1000px"},height:{type:String,default:"440px"}},data:function(){return{loading:!1,excelData:{header:null,results:null},excelFile:null,manchart:null,womanchart:null,contrastchart:null,category:[],options:[]}},created:function(){},mounted:function(){this.getData()},methods:{getData:function(){var t=this,e=h.a.create({baseURL:"/"});e({method:"get",url:"./data.xlsx",responseType:"blob",type:"xlsx"}).then((function(e){t.excelFile=e.data,t.readerData(e.data)}))},generateData:function(t){var e=t.header,a=t.results;this.excelData.header=e,this.excelData.results=a,this.onSuccess&&this.onSuccess(this.excelData)},readerData:function(t){var e=this;return this.loading=!0,new Promise((function(a,r){var s=new FileReader;s.onload=function(t){var r=t.target.result,s=l.a.read(r,{type:"array"}),n=s.SheetNames[3],i=s.Sheets[n],o=e.getHeaderRow(i),c=l.a.utils.sheet_to_json(i);e.generateData({header:o,results:c}),e.loading=!1,a()},s.readAsArrayBuffer(t)}))},getHeaderRow:function(t){var e,a=[],r=l.a.utils.decode_range(t["!ref"]),s=r.s.r;for(e=0;e<=r.e.c;++e){var n=t[l.a.utils.encode_cell({c:e,r:s})],i="UNKNOWN "+e;n&&n.t&&(i=l.a.utils.format_cell(n)),a.push(i);var o=[],c=void 0;for(c=0;c<=r.e.r;++c)if(0===e&&c>0){var h=t[l.a.utils.encode_cell({c:e,r:c})];this.category.push(h.v)}else{var u=t[l.a.utils.encode_cell({c:e,r:c})];o.push(u.v)}this.options.push({label:i,value:o})}return a},isExcel:function(t){return/\.(xlsx|xls|csv)$/.test(t.name)},showChart:function(t){this.contrastchart=d.a.init(document.getElementById("contrastchart")),this.manchart=d.a.init(document.getElementById("manchart")),this.womanchart=d.a.init(document.getElementById("womanchart"));for(var e=[],a=[],r=this.$data.excelData.results,s=0;s<r.length;s++)e.push(r[s].男性);for(var n=0;n<r.length;n++)a.push(r[n].女性);for(var i={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["男性","女性"]},xAxis:{type:"category",data:this.category},yAxis:{type:"value"},series:[{name:"男性",type:"bar",data:e},{name:"女性",type:"bar",data:a}]},o=[],l=0;l<this.category.length;l++)o.push({value:r[l].男性,type:"pie",name:this.category[l]});for(var c=[],h=0;h<this.category.length;h++)c.push({value:r[h].女性,type:"pie",name:this.category[h]});var u={title:{text:"男生群体属性重要性",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:this.category},series:[{name:"属性重要性",type:"pie",radius:"75%",center:["50%","60%"],data:o,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},p={title:{text:"女生群体属性重要性",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[{name:"属性重要性",type:"pie",radius:"75%",center:["50%","60%"],data:c,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};this.contrastchart.setOption(i),this.manchart.setOption(u),this.womanchart.setOption(p)}}},f=p,g=(a("f581"),a("2877")),m=Object(g["a"])(f,n,i,!1,null,"2082f170",null),v=m.exports,y={name:"UploadExcel",components:{UploadExcelComponent:v},data:function(){return{tableData:[],tableHeader:[]}},methods:{beforeUpload:function(t){var e=t.size/1024/1024<1;return!!e||(this.$message({message:"Please do not upload files larger than 1m in size.",type:"warning"}),!1)},handleSuccess:function(t){var e=t.results,a=t.header;this.tableData=e,this.tableHeader=a}}},x=y,w=Object(g["a"])(x,r,s,!1,null,null,null);e["default"]=w.exports},cd73:function(t,e,a){},f581:function(t,e,a){"use strict";var r=a("cd73"),s=a.n(r);s.a}}]);